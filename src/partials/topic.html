<h1 class="page-header">Components</h1>

<ol class="breadcrumb">
  <li><a ui-sref="topics">Home</a></li>
  <li class="active">Topic: {{topic.name}}</li>
</ol>

<uib-accordion close-others="true">
  <uib-accordion-group ng-repeat="(type, components) in componentsByTopic" is-open="opened">
    <uib-accordion-heading>{{ type }}
      <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': opened, 'glyphicon-chevron-right': !opened}"></i>
    </uib-accordion-heading>
    <div class="table-responsive">
      <table class="table table-condensed">
        <thead>
          <tr>
            <th>Name</th>
            <th>ID</th>
            <th class="text-center">Created At</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat-start="c in components"
            ng-click="c.opened = !c.opened">
            <td>{{ c.name }}</td>
            <td>{{ c.id }}</td>
            <td class="text-center">{{ c.created_at }}</td>
          </tr>
          <tr ng-repeat-end ng-if="c.opened">
            <td colspan="4">
              <form ng-submit="update(c)" novalidate>
                <input type="hidden" ng-model="c.id" ng-init="c.id=c.id"/>
                <input type="hidden" ng-model="c.topic_id" ng-init="c.topic_id=topic.id"/>
                <div class="form-group"><label>Name</label>
                  <input class="form-control" type="text" ng-model="c.name" required/>
                </div>
                <div class="form-group"><label>Type</label>
                  <input type="text" class="form-control" ng-model="c.type" required/>
                </div>
                <div class="form-group"><label>Canonical Project Name</label>
                  <textarea class="form-control" ng-model="c.canonical_project_name"></textarea>
                </div>
                <div class="form-group"><label>Data</label>
                  <textarea class="form-control" ng-model="c.data"></textarea>
                </div>
                <div class="form-group"><label>Title</label>
                  <textarea class="form-control" ng-model="c.title"></textarea>
                </div>
                <div class="form-group"><label>Message</label>
                  <textarea class="form-control" ng-model="c.message"></textarea>
                </div>
                <div class="form-group"><label>URL</label>
                  <textarea class="form-control" ng-model="c.url"></textarea>
                </div>
                <div class="form-group">
                  <button type="submit" class="btn btn-default">Update</button>
                  <button type="cancel" class="btn btn-default" ng-click="cancel()">Cancel</button>
                </div>
               <input type="hidden" ng-model="target.topic_id"/>
              </form>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </uib-accordion-group>
</uib-accordion>

<h2 ng-show="admin">Create new Component
<button ng-click="showCreateForm = !showCreateForm" class="btn btn-default glyphicon glyphicon-plus-sign" title="Create new component"></button>
</h2>

<div ng-show="showCreateForm">
<form name="createComponent" ng-submit="create()" novalidate>
  <input type="hidden" ng-model="c.topic_id" ng-init="c.topic_id=topic.id"/>
  <div class="form-group"><label>Name</label>
    <input class="form-control" type="text" ng-model="c.name" required/>
  </div>
  <div class="form-group"><label>Type</label>
    <input type="text" class="form-control" ng-model="c.type" required/>
  </div>
  <div class="form-group"><label>Canonical Project Name</label>
    <textarea class="form-control" ng-model="c.canonical_project_name"></textarea>
  </div>
  <div class="form-group"><label>Data</label>
    <textarea class="form-control" ng-model="c.data"></textarea>
  </div>
  <div class="form-group"><label>Title</label>
    <textarea class="form-control" ng-model="c.title"></textarea>
  </div>
  <div class="form-group"><label>Message</label>
    <textarea class="form-control" ng-model="c.message"></textarea>
  </div>
  <div class="form-group"><label>URL</label>
    <textarea class="form-control" ng-model="c.url"></textarea>
  </div>
  <div class="form-group">
    <button type="submit" class="btn btn-default">Update</button>
    <button type="cancel" class="btn btn-default" ng-click="cancel()">Cancel</button>
  </div>
</form>
</div>
